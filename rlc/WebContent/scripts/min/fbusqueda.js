function comprobar(){var fechaIni=formateaFechaYYYYMMDD($("#fini").val()),fInicio=Date.parse(fechaIni),fhoy=formateaFechaDateYYYYMMDD(hoy),fdhoy=Date.parse(fhoy),station=$("#station").val(),stationori=$("#stationOrig").val(),stationdes=$("#stationDest").val();return"none"==$(".visible").css("display")||void 0!==station&&""!=station?"none"==$(".oculta").css("display")||void 0!==stationori&&""!=stationori?"none"==$(".oculta").css("display")||void 0!==stationdes&&""!=stationdes?fInicio==fdhoy?compararHoraActual_HInicio():!0:(jAlert("Debes introducir una localidad destino","Alerta"),!1):(jAlert("Debes introducir una localidad origen","Alerta"),!1):(jAlert("Debes introducir una localidad","Alerta"),!1)}function cargarhorasminutosinicial(){var horaminutoinicial=$("#hinis").val();horaminutoinicial.length<5&&(horaminutoinicial="0"+horaminutoinicial);var arrayinicial=horaminutoinicial.split(":");$("#hini").val(arrayinicial[0]),$("#mini").val(arrayinicial[1])}function cargarhorasminutosfinal(){var horaminutoinicial=$("#hfins").val();horaminutoinicial.length<5&&(horaminutoinicial="0"+horaminutoinicial);var arrayinicial=horaminutoinicial.split(":");$("#hfin").val(arrayinicial[0]),$("#mfin").val(arrayinicial[1])}function inicializarFechas(){$("#fini").datepicker({minDate:0,dateFormat:"dd/mm/yy",numberOfMonths:1,onSelect:function(selected){var day=selected.substring(0,2),month=parseInt(selected.substring(3,5))-1,year=selected.substring(6,10),nextDay=new Date(year,month,day),dayweek=nextDay.getDay(),addday=1;6==dayweek&&(addday=1),nextDay.setDate(nextDay.getDate()+addday);var f6=formateaFechaDateDDMMYYYY(nextDay);$("#ffin").datepicker("option","minDate",f6)}}),$("#ffin").datepicker({minDate:0,dateFormat:"dd/mm/yy",numberOfMonths:1,onSelect:function(selected){$("#fini").datepicker("option","maxDate",selected)}})}function inicializarHoraInicio(){$("#hinis").val("12:00"),$("#hfins").val("12:00"),cargarhorasminutosinicial(),cargarhorasminutosfinal();var unafecha=new Date;unafecha.setDate(unafecha.getDate()+3);var dia=unafecha.getDay();0==dia&&unafecha.setDate(unafecha.getDate()+1);var f3=formateaFechaDateDDMMYYYY(unafecha);unafecha.setDate(unafecha.getDate()+3),dia=unafecha.getDay(),0==dia&&unafecha.setDate(unafecha.getDate()+1);var f6=formateaFechaDateDDMMYYYY(unafecha);$("#fini").val(f3),$("#ffin").val(f6)}function HoraRecogidaValida(){var h=hora_act+2;$("#hinis").val("13:00"),$("#hfins").val(h+":00")}function borrarContenidoStation(id){var valor=$("#"+id).val();("Dï¿½nde"==valor||"A"==valor)&&$("#"+id).val("")}function compararHoraActual_HInicio(){var h=parseInt($("#hini").val()),m=parseInt($("#mini").val()),mintot_select=60*h+m;return totminAct>=mintot_select?(jAlert("Error. La hora de recogida no puede ser inferior a la Hora Actual.","Error"),HoraRecogidaValida(),!1):!0}function noDomingos(date){var day=date.getDay();return[0!=day,""]}var hoy=new Date,hora_act=hoy.getHours(),min_act=hoy.getMinutes(),totminAct=60*hora_act+min_act;$(function(){inicializarHoraInicio(),$("#tvhiculo").buttonset(),$("#tsucursal").buttonset(),$("#hinis").selectmenu({change:function(event,data){cargarhorasminutosinicial()}}).selectmenu("menuWidget").addClass("overflow"),$("#hfins").selectmenu({change:function(event,data){cargarhorasminutosfinal()}}).selectmenu("menuWidget").addClass("overflow"),$("#station").autocomplete({source:arrstations,minLength:3,select:function(event,ui){var idcampo=(ui.item.value,ui.item.id);$("#stationid").val(idcampo)},change:function(event,ui){}}),$("#stationOrig").autocomplete({source:arrstations,minLength:3,select:function(event,ui){var idcampo=(ui.item.value,ui.item.id);$("#stationOrigid").val(idcampo)},change:function(event,ui){}}),$("#stationDest").autocomplete({source:arrstations,minLength:3,select:function(event,ui){var idcampo=(ui.item.value,ui.item.id);$("#stationDestid").val(idcampo)},change:function(event,ui){}}),$("input[type=checkbox][name=misma-oficina]").change(function(){$(this).is(":checked")?($("#tsucursal1").prop("checked",!0),$(".visible").css("display",""),$(".oculta").css("display","none"),$("#stationOrig").css("display","none"),$("#ofientrega").css("display","none"),$("#stationDest").css("display","none"),$("#station").css("display","")):($("#tsucursal2").prop("checked",!0),$(".visible").css("display","none"),$(".oculta").css("display","inline"),$("#stationOrig").css("display",""),$("#ofientrega").css("display",""),$("#stationDest").css("display",""),$("#station").css("display","none"))}),inicializarFechas(),$("#borrar").click(function(){$("#fini").val(""),$("#fini").datepicker("option","minDate",0),$("#fini").datepicker("option","maxDate",6e3),$("#ffin").val(""),$("#ffin").datepicker("option","minDate",0),$("#ffin").datepicker("option","maxDate",6e3),inicializarFechas()}),$("#mini").change(function(){var fechaIni=formateaFechaYYYYMMDD($("#fini").val()),fInicio=Date.parse(fechaIni),fhoy=formateaFechaDateYYYYMMDD(hoy),fdhoy=Date.parse(fhoy);fInicio==fdhoy&&compararHoraActual_HInicio()}),$("#hini").change(function(){var fechaIni=formateaFechaYYYYMMDD($("#fini").val()),fInicio=Date.parse(fechaIni),fhoy=formateaFechaDateYYYYMMDD(hoy),fdhoy=Date.parse(fhoy);fInicio==fdhoy&&compararHoraActual_HInicio()}),$("#buscar").click(function(){$(".wrape").hide(),$(".cargandobusqueda").show(),comprobar()?$("#formBuscador").submit():($(".cargandobusqueda").hide(),$(".wrape").show())}),$("#fechainicial").click(function(){$("#fini").datepicker("show")}),$("#fechafinal").click(function(){$("#ffin").datepicker("show")}),$("#horainicial").click(function(){$("#hinis").selectmenu("open")}),$("#horafinal").click(function(){$("#hfins").selectmenu("open")}),$(window).on("beforeunload",function(){location.href="servletRolecar?accion=cerrarSesion"})});
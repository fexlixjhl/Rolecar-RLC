function scrollToElement(target){var topoffset=30,speed=800,destination=jQuery(target).offset().top-topoffset;return jQuery("html:not(:animated),body:not(:animated)").animate({scrollTop:destination},speed,function(){window.location.hash=target}),!1}function comprobar(){var fechaIni=formateaFechaYYYYMMDD($("#fini").val()),fInicio=Date.parse(fechaIni),fhoy=formateaFechaDateYYYYMMDD(hoy),fdhoy=Date.parse(fhoy),station=$("#station").val(),stationori=$("#stationOrig").val(),stationdes=$("#stationDest").val();return"none"==$("#station").css("display")||void 0!==station&&""!=station?"none"==$("#stationOrig").css("display")||void 0!==stationori&&""!=stationori?"none"==$("#stationDest").css("display")||void 0!==stationdes&&""!=stationdes?fInicio==fdhoy?compararHoraActual_HInicio():!0:(jAlert("Debes introducir una localidad destino","Alerta"),!1):(jAlert("Debes introducir una localidad origen","Alerta"),!1):(jAlert("Debes introducir una localidad","Alerta"),!1)}function cargarhorasminutosinicial(){var horaminutoinicial=$("#hinis").val();horaminutoinicial.length<5&&(horaminutoinicial="0"+horaminutoinicial);var arrayinicial=horaminutoinicial.split(":");$("#hini").val(arrayinicial[0]),$("#mini").val(arrayinicial[1])}function cargarhorasminutosfinal(){var horaminutoinicial=$("#hfins").val();horaminutoinicial.length<5&&(horaminutoinicial="0"+horaminutoinicial);var arrayinicial=horaminutoinicial.split(":");$("#hfin").val(arrayinicial[0]),$("#mfin").val(arrayinicial[1])}function inicializarFechas(){$("#fini").datepicker({minDate:0,dateFormat:"dd/mm/yy",numberOfMonths:1,onSelect:function(selected){$("#ffin").datepicker("option","minDate",selected)}}),$("#ffin").datepicker({minDate:0,dateFormat:"dd/mm/yy",numberOfMonths:1,onSelect:function(selected){$("#fini").datepicker("option","maxDate",selected)}})}function inicializarHoraInicio(horai,horaf){$("#hinis").val(horai),$("#hfins").val(horaf),cargarhorasminutosinicial(),cargarhorasminutosfinal()}function HoraRecogidaValida(){var h=hora_act+2;$("#hinis").val("13:00"),$("#hfins").val(h+":00")}function compararHoraActual_HInicio(){var h=parseInt($("#hini").val()),m=parseInt($("#mini").val()),mintot_select=60*h+m,dif=mintot_select-totminAct;return totminAct>=mintot_select?(jAlert("Error. La hora de recogida no puede ser inferior a la Hora Actual.","Error"),HoraRecogidaValida(),!1):120>dif?(jAlert("Error. La hora m�nima de recogida es de 2 horas m�s, de la hora actual.Se coloca hora mas cercana valida","Error"),HoraRecogidaValida(),!1):!0}var hoy=new Date,hora_act=hoy.getHours(),min_act=hoy.getMinutes(),totminAct=60*hora_act+min_act;$(document).ready(function(){inicializarFechas(),inicializarHoraInicio(horarec,horaent),haycoches?($("#mensajevehiculostexto").hide(),$(".capacarrousel").show(),$("#ordenapor").show(),$(".Listado").show()):($("#mensajevehiculostexto").text(mensajeveh),$("#mensajevehiculostexto").show(),$(".capacarrousel").hide(),$("#ordenapor").hide(),$(".Listado").hide()),mismasucursal?($("input[type=checkbox][name=misma-oficina]").prop("checked",!0),$("#stationOrig").css("display","none"),$("#ofientrega").css("display","none"),$("#stationDest").css("display","none"),$("#station").css("display",""),$("#station").val(estacionori),$("#stationid").val(estacionoriid)):($("input[type=checkbox][name=misma-oficina]").prop("checked",!1),$(".oculta").css("display","inline-block"),$("#stationOrig").css("display",""),$("#ofientrega").css("display",""),$("#stationDest").css("display",""),$("#station").css("display","none"),$("#stationOrig").val(estacionori),$("#stationDest").val(estaciondes),$("#stationOrigid").val(estacionoriid),$("#stationDestid").val(estaciondesid)),$("#fini").val(fecharec),$("#hinis").val(horarec),$("#ffin").val(fechaent),$("#hfins").val(horaent),"CR"==crtype?$("#tvhiculo1").prop("checked",!0):$("#tvhiculo2").prop("checked",!0),$("#precio").click(function(e){var accion=$("#fordenar").attr("action");accion+="&Orden=1",$("#fordenar").attr("action",accion),$("#fordenar").submit()}),$("#tam").click(function(e){var accion=$("#fordenar").attr("action");accion+="&Orden=3",$("#fordenar").attr("action",accion),$("#fordenar").submit()}),$("#emi").click(function(e){var accion=$("#fordenar").attr("action");accion+="&Orden=5",$("#fordenar").attr("action",accion),$("#fordenar").submit()}),$(".resumen").click(function(){var num=$(this).attr("id");scrollToElement("#coche"+num)}),$(".carrousel").bxSlider({slideWidth:200,minSlides:2,maxSlides:5,slideMargin:10}),$("#hinis").selectmenu({change:function(event,data){cargarhorasminutosinicial()}}),$("#hfins").selectmenu({change:function(event,data){cargarhorasminutosfinal()}}),$("#station").autocomplete({source:arrstations,minLength:3,select:function(event,ui){var idcampo=(ui.item.value,ui.item.id);$("#stationid").val(idcampo)},change:function(event,ui){}}).val(estacionori),$("#stationOrig").autocomplete({source:arrstations,minLength:3,select:function(event,ui){var idcampo=(ui.item.value,ui.item.id);$("#stationOrigid").val(idcampo)},change:function(event,ui){}}).val(estacionori),$("#stationDest").autocomplete({source:arrstations,minLength:3,select:function(event,ui){var idcampo=(ui.item.value,ui.item.id);$("#stationDestid").val(idcampo)},change:function(event,ui){}}).val(estaciondes),$("input[type=radio][name=tsucursal]").change(function(){"tsucursal1"==this.value?($("#station").css("display",""),$("#stationOrig").css("display","none"),$("#ofientrega").css("display","none"),$("#stationDest").css("display","none")):"tsucursal2"==this.value&&($("#station").css("display","none"),$("#stationOrig").css("display",""),$("#ofientrega").css("display",""),$("#stationDest").css("display",""))}),$("#mini").change(function(){var fechaIni=formateaFechaYYYYMMDD($("#fini").val()),fInicio=Date.parse(fechaIni),fhoy=formateaFechaDateYYYYMMDD(hoy),fdhoy=Date.parse(fhoy);fInicio==fdhoy&&compararHoraActual_HInicio()}),$("#hini").change(function(){var fechaIni=formateaFechaYYYYMMDD($("#fini").val()),fInicio=Date.parse(fechaIni),fhoy=formateaFechaDateYYYYMMDD(hoy),fdhoy=Date.parse(fhoy);fInicio==fdhoy&&compararHoraActual_HInicio()}),$("#buscar").click(function(){$("#msgCargando").show(),scrollToElement("body"),comprobar()?$("#formBuscador").submit():$("#msgCargando").hide()}),$(".reserva").click(function(e){e.preventDefault(),$(".wrape").hide(),$(".cargandobusqueda").show(),scrollToElement(".cargandobusqueda");var div1padre=$(this).parent(),div2padre=div1padre.parent(),div3padre=div2padre.parent(),formpadre=div3padre.parent();comprobar()?setTimeout(function(){formpadre.submit()},5e3):($(".cargandobusqueda").hide(),$(".wrape").show())}),$("#otros").append('<div style="text-align:center;"><img src="images/iconocarga.gif" /></div>'),$.ajax({type:"POST",url:"ajax/conseguirlistadooficinas.jsp",data:"checkoutdate="+fecharec+"&checkouttime="+horarec+"&checkindate="+fechaent+"&checkintime="+horaent+"&carType="+crtype+"&codstationori="+codori+"&codstationdes="+coddes+"&provincia="+provincia,async:!0,success:function(msg){msg=jQuery.trim(msg),msg.length>0&&"<h2>Otras Localidades:</h2>"!=msg?$("#otros").fadeIn(1e3).html(msg):$("#otros").html("<p>NO hay sitios cercanos disponibles</p>"),$(".buscarloc").on("click",function(){var dato=$(this).attr("id"),descrestacion=$(this).attr("estacion");$("#station").val(descrestacion),$("#stationOrig").val(descrestacion),$("#stationid").val(dato),$("#stationOrigid").val(dato),$("#buscar").click()})},error:function(){$("#otros").html("<p>Error en la localizaci�n</p>")}}),$(document).tooltip({items:"[maleta],[asiento],[eco]",content:function(){var element=$(this);return element.is("[maleta]")?"<img src='images/maleta.png' alt='maletas'>capacidad de equipaje:"+element.attr("maleta"):element.is("[asiento]")?"<img src='images/asiento.png' alt='asientos'>capacidad de pasajeros:"+element.attr("asiento"):element.is("[eco]")?"<img src='images/eco.png' alt='ecologico'>Vehiculo ecol�gico:"+element.attr("eco")+"g/km<p>Nivel A: hasta 100g/km</p>":void 0},position:{my:"center bottom-20",at:"center top",using:function(position,feedback){$(this).css(position),$("<div>").addClass("arrow").addClass(feedback.vertical).addClass(feedback.horizontal).appendTo(this)}}}),$("#dialog-condiciones").dialog({autoOpen:!1,height:600,modal:!0}),$(".rate").click(function(event){if(event.preventDefault(),$(window).width()<=979)var sizeScreen=$(window).width();else var sizeScreen=980;var titulo=$(this).attr("titulo"),cod=$(this).attr("codigo"),cat=$(this).attr("categoria"),imagen=$(this).attr("imagen"),km=$(this).attr("km"),proteccion=$(this).attr("proteccion"),robo=$(this).attr("robo"),colision=$(this).attr("colision"),accidentesmej=$(this).attr("accidentesmej"),accidentes=$(this).attr("accidentes"),mercancias=$(this).attr("mercancias"),multas=$(this).attr("multas"),htmliconos=($(this).attr("adicional"),$("#iconoscar"+cod).html()),htmlcarac=$("#carac"+cod).html();htmliconos=jQuery.trim(htmliconos),htmlcarac=jQuery.trim(htmlcarac),"UNLIMITED"==km?$("#textokm").text($("#text_ilim").text()):$("#textokm").text(km+$("#text_lim").text()),""!=proteccion?$("#proteccion").text(proteccion):$("#proteccionli").css("display","none"),""!=robo?$("#robo").text(robo):$("#roboli").css("display","none"),""!=colision?$("#colision").text(colision):$("#colisionli").css("display","none"),""!=accidentesmej?$("#accidentesmej").text(accidentesmej):$("#accidentesmejli").css("display","none"),""!=accidentes?$("#accidentenormal").text(accidentes):$("#accidentesli").css("display","none"),""!=mercancias?$("#mercancias").text(mercancias):$("#mercanciasli").css("display","none"),""!=multas?$("#multas").text(multas):$("#multasli").css("display","none"),$("#typeV").text(""),$("#typeV").text(cat),$(".categoriacond").html(htmlcarac),$(".featurescond").html(htmliconos),$("#imagencondicion").attr("src","http://microsite.europcar.com/ECI/mkt/epcarvisuals/600x350/"+imagen),$("#dialog-condiciones").dialog({title:titulo,width:sizeScreen}),$("#dialog-condiciones").dialog("open")});var estacionorigen=$("#stationid").val(),estaciondistorigen=$("#stationOrigid").val();""!=estacionorigen?($("#stationOrigid").val(estacionorigen),estaciondistorigen=estacionorigen):""!=estaciondistorigen&&$("#stationid").val(estaciondistorigen),$(window).on("beforeunload",function(){location.href="servletRolecar?accion=cerrarSesion"})});